#labels Phase-Deploy
This page contains instructions for installing Bungeni Metavid on Linux. It may be possible to install Bungeni Metavid on other platforms but this has not been tested.

= Introduction =

Bungeni Metavid is a PHP application for the transcription of parliamentary records and is built on [http://metavid.ucsc.edu/ Metavid]

= Requirements =

Metavid Bungeni depends on

  * MediaWiki (current stable version is 1.12.0)
  * Web Server such as Apache or IIS
  * PHP version 5.0 or later (5.1.x recommended)
  * MySQL 4.0 or later
  * mod_annodex or oggz-chop
  * Semantic MediaWiki

= Preparing the installation =
  
  * Installing apache2, mysql and php and php-mysql:
{{{
sudo apt-get install apache2 mysql-server php5 php5-mysql
sudo apache2ctl restart # restart apache to load php and other modules
}}}

  * Install mod_annodex, this will install the following:
    * libannodex0 - annotated and indexed media library
    * libcmml1 - Continuous Media Markup Language document handler
    * libogg0 - Ogg Bitstream Library
    * libsndfile1 - Library for reading/writing audio files
    * liboggz1 - convenience interface for Ogg stream I/O
{{{
sudo apt-get install libannodex0 annodex-tools cmml-tools
}}}

 * Installing libgd image manipulation libraries :
{{{
sudo apt-get install libgd2-xpm libgd2-xpm-dev php5-gd
}}}

 * Configuring PHP  - edit php.ini 
{{{
sudo vim /etc/apache2/php/php.ini
}}}
    * Change - Maximum Upload Filesize
{{{
 #from : upload_max_filesize = 2M
 #to :
 upload_max_filesize = 8M
}}}
    * Change - Memory Limit
{{{ 
#from : memory_limit = 8M
# to
memory_limit = 16M
}}}

 * Configuring MySQL - we will need to add a mysql user for mediawiki :
{{{
#run the mysql admin from the command line 
mysql -u root -p mysql
}}}
  * when prompted, enter the root password for mysql
  * add a user called `wikiuser` :
{{{
mysql> GRANT ALL PRIVILEGES ON *.* TO 'wikiuser'@'localhost'
    IDENTIFIED BY 'some_pass' WITH GRANT OPTION;
}}}

= Installing MediaWiki =
 
  * We will install mediawiki in /var/www which is the document root folder for apache on ubuntu :
{{{
cd /var/www
#download mediawiki
sudo wget http://download.wikimedia.org/mediawiki/1.12/mediawiki-1.12.0.tar.gz
#extract the downloaded archive
sudo tar vxfz mediawiki-1.12.0.tar.gz
#rename the extracted folder to mvwiki
sudo mv mediawiki-1.12.0 mvwiki
#make the mediawiki config subdirectory writable by the web server.
cd /var/www/mvwiki
sudo chmod a+w config
}}}
 * Launch a web browser and run :
{{{
http://ip-of-server/mvwiki
}}}
   * Click setup, and on the next page enter the required settings
   * Enter the user name and password for mysql that you created in the previous step
   * Click 'install mediawiki'
   * Finally remove the installation configuration files :
{{{
undesa@mediawiki:/var/www/mvwiki$ sudo mv config/LocalSettings.php .
undesa@mediawiki:/var/www/mvwiki$ sudo rm -rf config
}}}

Help on installing Mediawiki extensions can be found [http://www.mediawiki.org/wiki/Manual:Extensions here]

Add the following lines to LocalSettings.php
{{{
ParserFunctions are necessary
require_once( "$IP/extensions/ParserFunctions/ParserFunctions.php" );

//set up namespace:
$smwgNamespaceIndex=100;
//set metavid namespace to smw namespace + 6
$mvNamespaceIndex=$smwgNamespaceIndex + 6;
include_once("$IP/extensions/MetavidWiki/includes/MV_Settings.php");

//include SemanticMediaWiki settings (if used) 
include_once("$IP/extensions/SemanticMediaWiki/includes/SMW_Settings.php");
enableSemantics('localhost');

//include after enableSemantics to enable metavid Extension semantic wiki overrides
enableMetavid();
}}}

Metavid Bungeni uses some extra tables in addition to those used by Mediawiki. Run the sql: maintenance/mv_tables.sql to add them.