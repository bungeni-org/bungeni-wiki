#summary Registry / Audit trail working document & guidelines
=Registry / Audit Trail Working Document=


==Purpose of Registry / Audit Trail==

  * To provide a relational view of Plone Content types.
  * The relational view must be consistent with the current state of the plone objects mapped to the registry table
  * The relational view must also be consistent with the the historical state of the plone object mapped to the registry table
  * To record change of state and transitions of a plone object in a uniform manner
  * To record the registry information in a relational database readable by external systems using standard database drivers


==How it Works==

  * An action taking place on a plone object is output into a plain text log file in the RFC822 format.
  * This log file is read periodically by a parsing script that reads the RFC822 data, record by record, parses it, does some basic
checks on it, and pumps it into a relational database.
  * Plone content types are mapped to a relational table, and this mapping is done via a configuration file.
  * Similarly Plone content attributes are mapped to table columns via a configuration file.
  * The frequency with which the script reads the audit log can be adjusted to reduce the lag between content published in plone, and content appearing in the registry.

==Guidelines==

  * Audit log must record in a predictable manner changes made to certain plone objects
  * Plone objects relevant to registry must be recorded in the audit log
  * Certain field (plone attribute) names (like identifier of MP) must be standardized across forms


==Synchronization==

  * The plone object and the corresponding registry entry for that plone object need to be kept in a synchronized state.
    * For example, If an MP is added in Plone, this MP must be recorded in the audit trail log file. If the state of the MP changes (if his name was changed, or if his role was changed ) - the change of state must be recorded as clearly identifiable states for a document.

